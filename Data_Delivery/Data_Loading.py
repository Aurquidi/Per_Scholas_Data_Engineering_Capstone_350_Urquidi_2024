# %% [markdown]
# # Creating the MySQL Database creditcard_capstone

# %%
!pip install PyMySQL
!pip install cryptography
!pip install mysql-connector-python
!pip install pyspark
!pip install --upgrade mysql-connector-python
!pip install cryptography

# %%
import pyspark.sql.functions as funct
import pymysql
from pyspark.sql.types import *
from mysql.connector import Error
import credentials as cred

# %% [markdown]
# ### Creating a mysql database called "creditcard_capstone" as prescribed in the Capstone guidance document

# %%
try:
    conn = pymysql.connect(
        host=cred.host,
        database='usersdb',
        user=cred.user,
        password=cred.password,
        port=cred.port
    )
    cursor = conn.cursor()
    cursor.execute("CREATE DATABASE creditcard_capstone")
    print('Database is created')
except pymysql.Error as e:
    print('Error while connecting to MySQL:', e)

# %% [markdown]
# ## Once the DB, creditcard_capstone has been created, the appropriate tables can be loaded directly from the spark dataframes.


